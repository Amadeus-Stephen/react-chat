{"ast":null,"code":"var _jsxFileName = \"/home/amadeus/react/react-chat/frontend/src/App.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport io from \"socket.io-client\";\nimport { BrowserRouter as Router, Route, Link } from \"react-router-dom\";\nimport HomePage from \"./componets/homePage\";\nconst server = \"http://localhost:5050\";\nconst socket = io.connect(server);\nlet current_user;\n\nif (JSON.parse(window.sessionStorage.getItem(\"user\"))) {\n  current_user = JSON.parse(window.sessionStorage.getItem(\"user\"))[0];\n} else {\n  current_user = {\n    username: \"\"\n  };\n}\n\nclass App extends React.Component {\n  render() {\n    return /*#__PURE__*/React.createElement(Router, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 19,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: \"/\",\n      exact: true,\n      component: HomePage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/chat/\",\n      exact: true,\n      component: ChatPage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nclass ChatPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onTextChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.onMessageSubmit = e => {\n      e.preventDefault();\n      socket.emit(\"chat_message\", {\n        user: this.state.user,\n        msg: this.state.msg,\n        type: this.props.match.params.chatype\n      });\n      this.setState({\n        msg: \"\"\n      });\n    };\n\n    this.state = {\n      msg: \"\",\n      chat: [],\n      user: current_user.username,\n      prevchatroom: this.props.match.params.chatroom\n    };\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    socket.emit(\"connect_to\", {\n      socket: this.props.match.params.chatroom,\n      type: this.props.match.params.chatype\n    });\n    socket.on(\"connect_to\", data => {\n      this.setState({\n        chat: data\n      });\n    });\n    socket.on(\"chat_message\", data => {\n      this.setState({\n        chat: [...this.state.chat, {\n          user: data.user,\n          msg: data.msg\n        }]\n      });\n\n      if (this.state.user === data.user) {\n        this.chatbox.scrollTo(0, this.chatbox.scrollHeight);\n      }\n    });\n  }\n\n  componentDidUpdate() {\n    if (this.state.prevchatroom !== this.props.match.params.chatroom) {\n      this.setState({\n        prevchatroom: this.props.match.params.chatroom\n      });\n      socket.emit(\"connect_to\", {\n        socket: this.props.match.params.chatroom,\n        type: this.props.match.params.chatype\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  renderChat() {\n    const {\n      chat\n    } = this.state;\n    return chat.map(({\n      user,\n      msg\n    }, idx) => {\n      if (user === current_user.username) {\n        return /*#__PURE__*/React.createElement(ChatLogs, {\n          tf: true,\n          key: idx,\n          msg: msg,\n          user: user,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 16\n          }\n        });\n      } else {\n        return /*#__PURE__*/React.createElement(ChatLogs, {\n          tf: false,\n          key: idx,\n          msg: msg,\n          user: user,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 16\n          }\n        });\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chatbackground chatpage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"render-chat\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chatbox\",\n      ref: c => this.chatbox = c,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, this.renderChat())), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.onMessageSubmit,\n      className: \" input-group messageform \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group-prepend\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn text-left text-info  input-group-prepend\",\n      onClick: this.onMessageSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 15\n      }\n    }, \"Send\")), /*#__PURE__*/React.createElement(\"input\", {\n      name: \"msg\",\n      className: \"form-control \",\n      onChange: e => this.onTextChange(e),\n      value: this.state.msg,\n      placeholder: \"message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n}\n/*\n<Navbar username={this.props.match.params.user} />\n*/\n\n\nclass ChatLogs extends React.Component {\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `${this.props.tf ? \"text-right\" : \"text-left\"} m-2`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"badge badge-dark\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"m-0 text-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }\n    }, this.props.msg)));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/amadeus/react/react-chat/frontend/src/App.js"],"names":["React","Component","axios","io","BrowserRouter","Router","Route","Link","HomePage","server","socket","connect","current_user","JSON","parse","window","sessionStorage","getItem","username","App","render","ChatPage","constructor","props","onTextChange","e","setState","target","name","value","onMessageSubmit","preventDefault","emit","user","state","msg","type","match","params","chatype","chat","prevchatroom","chatroom","_isMounted","componentDidMount","on","data","chatbox","scrollTo","scrollHeight","componentDidUpdate","componentWillUnmount","renderChat","map","idx","c","ChatLogs","tf"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport io from \"socket.io-client\";\nimport { BrowserRouter as Router, Route, Link } from \"react-router-dom\";\n\nimport HomePage from \"./componets/homePage\";\n\nconst server = \"http://localhost:5050\";\nconst socket = io.connect(server);\nlet current_user;\nif (JSON.parse(window.sessionStorage.getItem(\"user\"))) {\n  current_user = JSON.parse(window.sessionStorage.getItem(\"user\"))[0];\n} else {\n  current_user = { username: \"\" };\n}\nclass App extends React.Component {\n  render() {\n    return (\n      <Router>\n        <Route path=\"/\" exact component={HomePage} />\n        <Route path=\"/chat/\" exact component={ChatPage} />\n      </Router>\n    );\n  }\n}\n\nclass ChatPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      msg: \"\",\n      chat: [],\n      user: current_user.username,\n      prevchatroom: this.props.match.params.chatroom,\n    };\n    this._isMounted = false;\n  }\n  componentDidMount() {\n    this._isMounted = true;\n    socket.emit(\"connect_to\", {\n      socket: this.props.match.params.chatroom,\n      type: this.props.match.params.chatype,\n    });\n    socket.on(\"connect_to\", (data) => {\n      this.setState({ chat: data });\n    });\n    socket.on(\"chat_message\", (data) => {\n      this.setState({\n        chat: [...this.state.chat, { user: data.user, msg: data.msg }],\n      });\n      if (this.state.user === data.user) {\n        this.chatbox.scrollTo(0, this.chatbox.scrollHeight);\n      }\n    });\n  }\n  componentDidUpdate() {\n    if (this.state.prevchatroom !== this.props.match.params.chatroom) {\n      this.setState({ prevchatroom: this.props.match.params.chatroom });\n      socket.emit(\"connect_to\", {\n        socket: this.props.match.params.chatroom,\n        type: this.props.match.params.chatype,\n      });\n    }\n  }\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n  onTextChange = (e) => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  onMessageSubmit = (e) => {\n    e.preventDefault();\n    socket.emit(\"chat_message\", {\n      user: this.state.user,\n      msg: this.state.msg,\n      type: this.props.match.params.chatype,\n    });\n    this.setState({ msg: \"\" });\n  };\n\n  renderChat() {\n    const { chat } = this.state;\n    return chat.map(({ user, msg }, idx) => {\n      if (user === current_user.username) {\n        return <ChatLogs tf={true} key={idx} msg={msg} user={user} />;\n      } else {\n        return <ChatLogs tf={false} key={idx} msg={msg} user={user} />;\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"chatbackground chatpage\">\n          <div className=\"render-chat\">\n            <div className=\"chatbox\" ref={(c) => (this.chatbox = c)}>\n              {this.renderChat()}\n            </div>\n          </div>\n          <form\n            onSubmit={this.onMessageSubmit}\n            className=\" input-group messageform \"\n          >\n            <div className=\"input-group-prepend\">\n              <button\n                type=\"button\"\n                className=\"btn text-left text-info  input-group-prepend\"\n                onClick={this.onMessageSubmit}\n              >\n                Send\n              </button>\n            </div>\n            <input\n              name=\"msg\"\n              className=\"form-control \"\n              onChange={(e) => this.onTextChange(e)}\n              value={this.state.msg}\n              placeholder=\"message\"\n            />\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n/*\n<Navbar username={this.props.match.params.user} />\n*/\nclass ChatLogs extends React.Component {\n  render() {\n    return (\n      <div className={`${this.props.tf ? \"text-right\" : \"text-left\"} m-2`}>\n        <span className=\"badge badge-dark\">\n          <h6 className=\"m-0 text-info\">{this.props.msg}</h6>\n        </span>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}