{"ast":null,"code":"import _classCallCheck from\"/home/amadeus/react/react-chat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/amadeus/react/react-chat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/amadeus/react/react-chat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/amadeus/react/react-chat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/amadeus/react/react-chat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import io from\"socket.io-client\";import axios from\"axios\";import{Route}from\"react-router-dom\";import HomePage from\"./componets/homePage\";import LeftNavbar from\"./componets/navbar/leftNavbar\";import TopNavbar from\"./componets/navbar/topNavbar\";import ChatPage from\"./componets/chat/chatPage\";import SignupPage from\"./componets/user/signupPage\";import LoginPage from\"./componets/user/loginPage\";import ThrowFlash from\"./componets/util/throwFlash\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);_this=_super.call(this);_this._isMounted=false;_this.socket=io.connect(\"/\");_this.state={loggedIn:false,username:null,userid:null,chatroom:null,id:null,flashes:[],redirectTo:null};_this.updateAppState=_this.updateAppState.bind(_assertThisInitialized(_this));_this.createChat=_this.createChat.bind(_assertThisInitialized(_this));_this.getUser=_this.getUser.bind(_assertThisInitialized(_this));_this.logout=_this.logout.bind(_assertThisInitialized(_this));_this.login=_this.login.bind(_assertThisInitialized(_this));_this.signup=_this.signup.bind(_assertThisInitialized(_this));_this.addFlash=_this.addFlash.bind(_assertThisInitialized(_this));_this.removeFlash=_this.removeFlash.bind(_assertThisInitialized(_this));_this.setRedirect=_this.setRedirect.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this._isMounted=true;this.setState({redirectTo:null});this.socket.on(\"init\",function(data){_this2.addFlash({success:true,msg:data});});this.getUser();this.socket.on(\"user_not_signed_in\",function(){_this2.addFlash({success:false,msg:\"You need to signin to use that feature\"});});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this._isMounted=false;}},{key:\"updateAppState\",value:function updateAppState(stateObject){this.setState(stateObject);}},{key:\"createChat\",value:function createChat(name){var _this3=this;axios.post(\"/chatroom/\",{name:name,owner:this.state.userid}).then(function(response){if(response.status===200){if(response.data.error){var msg=response.data.error.msg;_this3.addFlash({success:false,msg:msg});}else{if(response.data.success){var _msg=response.data.success.msg;_this3.addFlash({success:true,msg:_msg});_this3.socket.emit(\"get_chats\");}}}});}},{key:\"getUser\",value:function getUser(){var _this4=this;axios.get(\"/user/\").then(function(response){if(response.data.user){_this4.setState({loggedIn:true,username:response.data.user.username,userid:response.data.user._id});}else{_this4.setState({loggedIn:false,username:null});}});}},{key:\"logout\",value:function logout(){var _this5=this;axios.post(\"/user/logout\").then(function(response){//sends a post request to log user out of current session\nif(response.status===200){_this5.addFlash({success:true,msg:\"Successfully logged out\"});_this5.setState({loggedIn:false,username:null});}}).catch(function(error){console.log(\"Logout error\",error);});}},{key:\"login\",value:function login(username,password){var _this6=this;axios.post(\"/user/login\",{username:username,password:password}).then(function(response){if(response.status===200){if(response.data.error){var msg=response.data.error.msg;_this6.addFlash({success:false,msg:msg});}else{_this6.setState({loggedIn:true,username:response.data.username});_this6.addFlash({success:true,msg:\"Logged in successfully \"});_this6.setRedirect(\"/\");}}}).catch(function(error){console.log(error);_this6.addFlash({success:false,msg:\"An unexpected error has occurred. Please try again later\"});});}},{key:\"signup\",value:function signup(username,email,password,confirmPassword){var _this7=this;axios.post(\"/user/\",{username:username,email:email,password:password,confirmPassword:confirmPassword}).then(function(response){if(response.data.error){var msg=response.data.error.msg;_this7.addFlash({success:false,msg:msg});}else{console.log(response.data);_this7.addFlash({success:true,msg:\"Successfully created account\"});_this7.setRedirect(\"/login\");}}).catch(function(error){console.log(error);_this7.addFlash({success:false,msg:\"An unexpected error has occurred. Please try again later\"});});}},{key:\"addFlash\",value:function addFlash(flash){var flashes=this.state.flashes;flashes.push(flash);this.setState({flashes:flashes});}},{key:\"removeFlash\",value:function removeFlash(index){var flashes=this.state.flashes;flashes.splice(index,1);this.setState({flashes:flashes});}},{key:\"setRedirect\",value:function setRedirect(redirectTo){this.setState({redirectTo:redirectTo});}},{key:\"renderFlash\",value:function renderFlash(){var _this8=this;return this.state.flashes.map(function(_ref,index){var msg=_ref.msg,success=_ref.success;return/*#__PURE__*/React.createElement(ThrowFlash,{removeFlash:_this8.removeFlash,msg:msg,success:success,index:index,key:index,length:_this8.state.flashes.length});});}},{key:\"render\",value:function render(){var _this9=this;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TopNavbar,{logout:this.logout,loggedIn:this.state.loggedIn}),/*#__PURE__*/React.createElement(LeftNavbar,{updateAppState:this.updateAppState,createChat:this.createChat,socket:this.socket}),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-5 \"},this.renderFlash(),/*#__PURE__*/React.createElement(Route,{path:\"/\",exact:true,render:function render(){return/*#__PURE__*/React.createElement(HomePage,{user:_this9.state.username,loggedIn:_this9.state.loggedIn});}}),/*#__PURE__*/React.createElement(Route,{path:\"/chat/\",render:function render(){return/*#__PURE__*/React.createElement(ChatPage,{updateAppState:_this9.updateAppState,addFlash:_this9.addFlash,id:_this9.state.id,socket:_this9.socket,username:_this9.state.username,userid:_this9.state.userid});}}),/*#__PURE__*/React.createElement(Route,{path:\"/login\",render:function render(){return/*#__PURE__*/React.createElement(LoginPage,{login:_this9.login,loggedIn:_this9.state.loggedIn,redirectTo:_this9.state.redirectTo,setRedirect:_this9.setRedirect});}}),/*#__PURE__*/React.createElement(Route,{path:\"/signup\",render:function render(){return/*#__PURE__*/React.createElement(SignupPage,{signup:_this9.signup,redirectTo:_this9.state.redirectTo,setRedirect:_this9.setRedirect});}})));}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/home/amadeus/react/react-chat/frontend/src/App.js"],"names":["React","Component","io","axios","Route","HomePage","LeftNavbar","TopNavbar","ChatPage","SignupPage","LoginPage","ThrowFlash","App","_isMounted","socket","connect","state","loggedIn","username","userid","chatroom","id","flashes","redirectTo","updateAppState","bind","createChat","getUser","logout","login","signup","addFlash","removeFlash","setRedirect","setState","on","data","success","msg","stateObject","name","post","owner","then","response","status","error","emit","get","user","_id","catch","console","log","password","email","confirmPassword","flash","push","index","splice","map","length","renderFlash"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport io from \"socket.io-client\";\nimport axios from \"axios\";\nimport { Route } from \"react-router-dom\";\nimport HomePage from \"./componets/homePage\";\n\nimport LeftNavbar from \"./componets/navbar/leftNavbar\";\nimport TopNavbar from \"./componets/navbar/topNavbar\";\n\nimport ChatPage from \"./componets/chat/chatPage\";\n\nimport SignupPage from \"./componets/user/signupPage\";\nimport LoginPage from \"./componets/user/loginPage\";\n\nimport ThrowFlash from \"./componets/util/throwFlash\";\n\nclass App extends Component {\n  _isMounted = false;\n  constructor() {\n    super();\n    this.socket = io.connect(\"/\");\n    this.state = {\n      loggedIn: false,\n      username: null,\n      userid: null,\n      chatroom: null,\n      id: null,\n      flashes: [],\n      redirectTo: null,\n    };\n    this.updateAppState = this.updateAppState.bind(this);\n    this.createChat = this.createChat.bind(this);\n    this.getUser = this.getUser.bind(this);\n    this.logout = this.logout.bind(this);\n    this.login = this.login.bind(this);\n    this.signup = this.signup.bind(this);\n    this.addFlash = this.addFlash.bind(this);\n    this.removeFlash = this.removeFlash.bind(this);\n    this.setRedirect = this.setRedirect.bind(this);\n  }\n  componentDidMount() {\n    this._isMounted = true;\n    this.setState({ redirectTo: null });\n    this.socket.on(\"init\", (data) => {\n      this.addFlash({ success: true, msg: data });\n    });\n    this.getUser();\n    this.socket.on(\"user_not_signed_in\", () => {\n      this.addFlash({\n        success: false,\n        msg: \"You need to signin to use that feature\",\n      });\n    });\n  }\n  componentDidUpdate() {\n    this._isMounted = false;\n  }\n  updateAppState(stateObject) {\n    this.setState(stateObject);\n  }\n  createChat(name) {\n    axios\n      .post(\"/chatroom/\", {\n        name,\n        owner: this.state.userid,\n      })\n      .then((response) => {\n        if (response.status === 200) {\n          if (response.data.error) {\n            let msg = response.data.error.msg;\n            this.addFlash({ success: false, msg });\n          } else {\n            if (response.data.success) {\n              let msg = response.data.success.msg;\n              this.addFlash({ success: true, msg });\n              this.socket.emit(\"get_chats\");\n            }\n          }\n        }\n      });\n  }\n  getUser() {\n    axios.get(\"/user/\").then((response) => {\n      if (response.data.user) {\n        this.setState({\n          loggedIn: true,\n          username: response.data.user.username,\n          userid: response.data.user._id,\n        });\n      } else {\n        this.setState({\n          loggedIn: false,\n          username: null,\n        });\n      }\n    });\n  }\n  logout() {\n    axios\n      .post(\"/user/logout\")\n      .then((response) => {\n        //sends a post request to log user out of current session\n        if (response.status === 200) {\n          this.addFlash({ success: true, msg: \"Successfully logged out\" });\n          this.setState({\n            loggedIn: false,\n            username: null,\n          });\n        }\n      })\n      .catch((error) => {\n        console.log(\"Logout error\", error);\n      });\n  }\n  login(username, password) {\n    axios\n      .post(\"/user/login\", { username, password })\n      .then((response) => {\n        if (response.status === 200) {\n          if (response.data.error) {\n            let msg = response.data.error.msg;\n            this.addFlash({ success: false, msg });\n          } else {\n            this.setState({\n              loggedIn: true,\n              username: response.data.username,\n            });\n            this.addFlash({ success: true, msg: \"Logged in successfully \" });\n            this.setRedirect(\"/\");\n          }\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.addFlash({\n          success: false,\n          msg: \"An unexpected error has occurred. Please try again later\",\n        });\n      });\n  }\n  signup(username, email, password, confirmPassword) {\n    axios\n      .post(\"/user/\", { username, email, password, confirmPassword })\n      .then((response) => {\n        if (response.data.error) {\n          let msg = response.data.error.msg;\n          this.addFlash({ success: false, msg });\n        } else {\n          console.log(response.data);\n          this.addFlash({ success: true, msg: \"Successfully created account\" });\n          this.setRedirect(\"/login\");\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.addFlash({\n          success: false,\n          msg: \"An unexpected error has occurred. Please try again later\",\n        });\n      });\n  }\n  addFlash(flash) {\n    let flashes = this.state.flashes;\n    flashes.push(flash);\n    this.setState({ flashes });\n  }\n  removeFlash(index) {\n    let flashes = this.state.flashes;\n    flashes.splice(index, 1);\n    this.setState({ flashes });\n  }\n\n  setRedirect(redirectTo) {\n    this.setState({ redirectTo });\n  }\n  renderFlash() {\n    return this.state.flashes.map(({ msg, success }, index) => {\n      return (\n        <ThrowFlash\n          removeFlash={this.removeFlash}\n          msg={msg}\n          success={success}\n          index={index}\n          key={index}\n          length={this.state.flashes.length}\n        />\n      );\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <TopNavbar logout={this.logout} loggedIn={this.state.loggedIn} />\n        <LeftNavbar\n          updateAppState={this.updateAppState}\n          createChat={this.createChat}\n          socket={this.socket}\n        />\n        <div className=\"mt-5 \">\n          {this.renderFlash()}\n          <Route\n            path=\"/\"\n            exact\n            render={() => (\n              <HomePage\n                user={this.state.username}\n                loggedIn={this.state.loggedIn}\n              />\n            )}\n          />\n          <Route\n            path=\"/chat/\"\n            render={() => (\n              <ChatPage\n                updateAppState={this.updateAppState}\n                addFlash={this.addFlash}\n                id={this.state.id}\n                socket={this.socket}\n                username={this.state.username}\n                userid={this.state.userid}\n              />\n            )}\n          />\n          <Route\n            path=\"/login\"\n            render={() => (\n              <LoginPage\n                login={this.login}\n                loggedIn={this.state.loggedIn}\n                redirectTo={this.state.redirectTo}\n                setRedirect={this.setRedirect}\n              />\n            )}\n          />\n          <Route\n            path=\"/signup\"\n            render={() => (\n              <SignupPage\n                signup={this.signup}\n                redirectTo={this.state.redirectTo}\n                setRedirect={this.setRedirect}\n              />\n            )}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}